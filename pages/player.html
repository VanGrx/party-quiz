<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Grkinho</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script>


var answerGiven = false;
var newQuestion = false;
var currentQuestion = 0;

function giveAnswer(index){


var data = {};

data["answer"]=index;
data["playerID"]=document.getElementById("playerID").innerHTML;

answerGiven = true;

$.ajax({
  type: "POST",
  url: "./player.html",
  data: data,
  success: function(data){
        console.log("Answered");

      },
  error: function(error){
    console.log("Error:");
    console.log(error);
}
});

}


function handlePlayerStatus(status){


document.getElementById("playerID").innerHTML = status["player"]["id"];
document.getElementById("playerUsername").innerHTML = status["player"]["username"];

document.getElementById("score").innerHTML = status["player"]["score"];


var currQuestion = status["currQuestion"]+1;
var questionText = currQuestion+"/"+status["totalQuestions"];
document.getElementById("questions").innerHTML = questionText;


if(status["gameReady"] == true && status["gameStarted"] == false){


} else if(status["gameOver"] == false && currQuestion!=currentQuestion){

  currentQuestion = currQuestion;
  answerGiven = false;
  document.getElementById("pitanjeDiv").style.display = "block";
  document.getElementById("question").innerHTML = status["question"];
  document.getElementById("answer1").innerHTML = status["answers"][0];
  document.getElementById("answer2").innerHTML = status["answers"][1];
  document.getElementById("answer3").innerHTML = status["answers"][2];
  document.getElementById("answer4").innerHTML = status["answers"][3];



} else if(answerGiven == true){
document.getElementById("pitanjeDiv").style.display = "none";

}
}


function getPlayerStatus(){

var data = {};

data["status"]="1";

var res = JSON.stringify(data)

console.log(res);


$.ajax({
  type: "GET",
  url: "./player.html",
  data: data,
  success: function(data){
        handlePlayerStatus(data);

      },
  error: function(error){
    console.log("Error:");
    console.log(error);
}
});

}

window.setInterval(function(){
  getPlayerStatus();  //calling every .5 seconds
}, 500);

</script>


</head>
<body>
<label >Igracev ID:</label><label id="playerID"></label>
<label >Igrac:</label><label id="playerUsername"></label>
<div id="pitanjeDiv" name="pitanjeDiv" style.display = "none">

<label >Pitanje:</label>
<label id="questions">0/0</label>

<label >Rezultat:</label>
<label id="score">0</label>
<br/><br/>
<label id="question"></label><br/>
<button id="answer1" onClick="giveAnswer(0)"></button><br/>
<button id="answer2" onClick="giveAnswer(1)"></button><br/>
<button id="answer3" onClick="giveAnswer(2)"></button><br/>
<button id="answer4" onClick="giveAnswer(3)"></button><br/>
</div>
</form>
</body>
</html>
